const timelineData = [
  {
    pillYear: "1840",
    boxYear: "1840",
    title: "Nascimento em Paris",
    image: "images/timeline/rodin-1840.jpg",
    description: "Auguste Rodin nasce em 12 de novembro, em Paris, numa família humilde.",
    details: "Nascido em 12 de novembro de 1840, François-Auguste-René Rodin cresceu num ambiente modesto. Desde cedo mostrou talento para o desenho, fato que se tornou evidente nos registros de infância e cartas do escultor.",
    source: "Fonte: Musée Rodin, https://www.musee-rodin.fr/en/auguste-rodin/biography"
  },
  {
    pillYear: "1857",
    boxYear: "1857",
    title: "Rejeição na École des Beaux-Arts",
    image: "images/timeline/rodin-1857.jpg",
    description: "Rodin é recusado pela Escola de Belas Artes de Paris após três tentativas.",
    details: "Rodin foi recusado três vezes na École des Beaux-Arts a partir de 1857, sendo considerado inadequado ao padrão acadêmico. Isso o levou a buscar trabalho como artesão, onde desenvolveu sua própria visão.",
    source: "Fonte: Musée Rodin, https://www.musee-rodin.fr/en/auguste-rodin/biography"
  },
  {
    pillYear: "1862",
    boxYear: "1862",
    title: "Morte da irmã Maria",
    image: "images/timeline/rodin-1862.jpg",
    description: "Rodin sofre com a perda da irmã e vive crise espiritual.",
    details: "Em 1862, a morte de sua irmã Maria o abateu profundamente. Pausou a carreira, chegando a entrar num convento, mas acabou sendo incentivado por um padre a retomar a escultura.",
    source: "Fonte: Musée Rodin, https://www.musee-rodin.fr/en/auguste-rodin/biography"
  },
  {
    pillYear: "1864",
    boxYear: "1864",
    title: "‘O Homem com o Nariz Quebrado’",
    image: "images/timeline/rodin-1864.jpg",
    description: "Conclui a escultura ‘O Homem com o Nariz Quebrado’, que rompe com o academicismo.",
    details: "'O Homem com o Nariz Quebrado', iniciado em 1863 e finalizado em 1864, foi rejeitado pelo Salão de Paris por seu realismo cru, mas é hoje reconhecido como marco do início de seu estilo pessoal.",
    source: "Fonte: Musée Rodin, https://www.musee-rodin.fr/en/auguste-rodin/biography | Textlog.de, https://www.textlog.de/3680.html"
  },
  {
    pillYear: "1875",
    boxYear: "1875",
    title: "Viagem à Itália",
    image: "images/timeline/rodin-1875.jpg",
    description: "Visita Itália e se inspira em Michelangelo e Donatello.",
    details: "Em 1875, Rodin viaja à Itália, onde estuda de perto as esculturas de Michelangelo e Donatello, incorporando novos conceitos de movimento e força à sua própria obra.",
    source: "Fonte: Musée Rodin, https://www.musee-rodin.fr/en/auguste-rodin/biography"
  },
  {
    pillYear: "1877",
    boxYear: "1877",
    title: "‘A Idade do Bronze’",
    image: "images/timeline/rodin-1877.jpg",
    description: "Exibe 'L'Âge d’Airain', cuja verossimilhança causa escândalo.",
    details: "Em 1877, Rodin expôs 'A Idade do Bronze', obra que causou escândalo pelo realismo, sendo acusado de ter moldado direto do corpo de um modelo vivo.",
    source: "Fonte: Musée Rodin, https://www.musee-rodin.fr/en/collections/sculptures/age-bronze | Met Museum, https://www.metmuseum.org/art/collection/search/191803"
  },
  {
    pillYear: "1880",
    boxYear: "1880",
    title: "‘O Portão do Inferno’",
    image: "images/timeline/rodin-1880.jpg",
    description: "Recebe a encomenda para 'Os Portões do Inferno', inspirado em Dante.",
    details: "Em 1880, Rodin recebe a encomenda de uma porta monumental para o Museu de Artes Decorativas, inspirando-se na 'Divina Comédia'. Muitas esculturas icônicas surgiram desse projeto, como 'O Pensador'.",
    source: "Fonte: Musée Rodin, https://www.musee-rodin.fr/en/collections/sculptures/gates-hell | Met Museum, https://www.metmuseum.org/art/collection/search/191804"
  },
  {
    pillYear: "1884",
    boxYear: "1884",
    title: "‘Os Burgueses de Calais’",
    image: "images/timeline/rodin-1884.jpg",
    description: "Inicia o monumento, rompendo com o estilo heroico tradicional.",
    details: "O monumento 'Os Burgueses de Calais', encomendado em 1884, inovou ao retratar cidadãos comuns, com expressão de sofrimento e humanidade, rompendo com o heroísmo tradicional da escultura pública.",
    source: "Fonte: Musée Rodin, https://www.musee-rodin.fr/en/collections/sculptures/burghers-calais | Met Museum, https://www.metmuseum.org/art/collection/search/191811"
  },
  {
    pillYear: "1897",
    boxYear: "1897",
    title: "Monumento a Balzac",
    image: "images/timeline/rodin-1897.jpg",
    description: "Apresenta o controverso Balzac, inicialmente rejeitado.",
    details: "Rodin inicia o projeto Balzac em 1891, apresenta o modelo em 1898 e enfrenta forte rejeição pelo estilo inovador, mas a obra é hoje vista como precursora da escultura moderna.",
    source: "Fonte: Musée Rodin, https://www.musee-rodin.fr/en/collections/sculptures/balzac | Textlog.de, https://www.textlog.de/3688.html"
  },
  {
    pillYear: "1900",
    boxYear: "1900",
    title: "Exposição Universal de Paris",
    image: "images/timeline/rodin-1900.jpg",
    description: "Exibe cerca de 150 obras em pavilhão próprio.",
    details: "Durante a Exposição Universal de Paris de 1900, Rodin monta seu próprio pavilhão na Place de l’Alma, exibindo mais de 150 esculturas e consolidando sua fama internacional.",
    source: "Fonte: Musée Rodin, https://www.musee-rodin.fr/en/auguste-rodin/biography"
  },
  {
    pillYear: "1917",
    boxYear: "1917",
    title: "Morte em Meudon",
    image: "images/timeline/rodin-1917.jpg",
    description: "Morre em 17 de novembro, deixando legado ao Estado.",
    details: "Rodin faleceu em 17 de novembro de 1917, em Meudon. Em seu testamento, deixou todas as suas obras e coleções ao Estado francês, possibilitando a criação do Musée Rodin.",
    source: "Fonte: Musée Rodin, https://www.musee-rodin.fr/en/auguste-rodin/biography"
  }
];

class Timeline {
  constructor() {
    this.container = document.querySelector('.timeline-container');
    this.modal = document.getElementById('timeline-modal');
    this.modalTitle = document.getElementById('timeline-modal-title');
    this.modalContent = document.getElementById('timeline-modal-content');
    this.isMobile = window.innerWidth <= 1024;
    this.init();
  }

  init() {
    if (!this.container) return;
    this.render();
    this.bindEvents();
    window.addEventListener('resize', this.debounce(() => {
      const newIsMobile = window.innerWidth <= 1024;
      if (newIsMobile !== this.isMobile) {
        this.isMobile = newIsMobile;
        this.render();
      }
    }, 250));
  }

  render() {
    if (this.isMobile) {
      this.renderMobile();
    } else {
      this.renderDesktop();
    }
  }

  renderDesktop() {
    let html = '<div class="timeline-grid-desktop">';
    timelineData.forEach((item, index) => {
      html += this.createDesktopItem(item, index);
    });
    html += '</div>';
    this.container.innerHTML = html;
  }

  renderMobile() {
    let html = '<div class="timeline-grid-mobile">';
    timelineData.forEach((item, index) => {
      html += this.createMobileItem(item, index);
    });
    html += '</div>';
    this.container.innerHTML = html;
  }

createDesktopItem(item, index) {
  const itemNumber = String(index + 1).padStart(2, '0');
  return `
    <div class="timeline-item-desktop" data-index="${index}">
      <div class="timeline-content-top">
        <div class="timeline-number-circle">${itemNumber}</div>
        <h3 class="timeline-title">${item.title}</h3>
        <p class="timeline-description">${item.description}</p>
      </div>
      <div class="timeline-connector">
        <div class="timeline-vertical-line"></div>
        <div class="timeline-year-pill">${item.pillYear}</div>
      </div>
      <div class="timeline-photo-container">
        <img src="${item.image}" alt="${item.title}" class="timeline-photo" onerror="this.style.display='none'">
      </div>
    </div>
    <hr class="timeline-separator">
  `;
}


  createMobileItem(item, index) {
    const itemNumber = String(index + 1).padStart(2, '0');
    return `
      <div class="timeline-item-mobile" data-index="${index}">
        <div class="timeline-number-circle">${itemNumber}</div>
        <div class="timeline-content-mobile">
          <h3 class="timeline-title">${item.title}</h3>
          <p class="timeline-description">${item.description}</p>
          <div class="timeline-year-pill">${item.pillYear}</div>
        </div>
      </div>
    `;
  }

  bindEvents() {
    this.container.addEventListener('click', (e) => {
      const item = e.target.closest('[data-index]');
      if (item) {
        const index = parseInt(item.dataset.index);
        this.showTimelineModal(index);
      }
    });
  }

  showTimelineModal(index) {
    const item = timelineData[index];
    this.modalTitle.textContent = `${item.pillYear} - ${item.title}`;
    this.modalContent.innerHTML = `
      <div style="text-align:center; margin-bottom: 20px;">
        <img src="${item.image}" alt="${item.title}" style="max-width: 300px; max-height: 300px; border-radius: 10px;" onerror="this.style.display='none'">
      </div>
      <h3>Detalhes do Evento</h3>
      <p>${item.details}</p>
      <div class="timeline-source" style="font-size: 0.95em; color: #888; font-style: italic; margin-top: 16px;">
        ${item.source ? item.source : ''}
      </div>
    `;
    this.modal.style.display = 'block';
    document.body.style.overflow = 'hidden';
  }

  debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
      const later = () => {
        clearTimeout(timeout);
        func(...args);
      };
      clearTimeout(timeout);
      timeout = setTimeout(later, wait);
    };
  }
}

document.addEventListener('DOMContentLoaded', () => {
  window.timeline = new Timeline();
});
